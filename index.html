<!DOCTYPE html> 
 <html> 
 <head> 
   <base href="/chatweb/"> 
   <meta charset="UTF-8"> 
   <title>Chat</title> 
   <link rel="manifest" href="manifest.json"> 
   <script> 
     // Força renderizador HTML para evitar tela branca 
     window.flutterWebRenderer = "html"; 
   </script> 
   <!-- OneSignal SDK -->
   <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
 </head> 
 <body style="background-color: #f3f3f3; margin: 0;"> 
   <div id="loading-msg" style="display:flex;justify-content:center;align-items:center;height:100vh;flex-direction:column;font-family:sans-serif;"> 
     <div class="spinner"></div> 
     <p style="margin-top: 20px; color: #666;">Carregando chat...</p> 
   </div> 
   <style>
     .spinner {
       width: 40px;
       height: 40px;
       border: 4px solid #ddd;
       border-top: 4px solid #3498db;
       border-radius: 50%;
       animation: spin 1s linear infinite;
     }
     @keyframes spin {0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}
   </style> 
 
   <script src="flutter.js" defer></script> 
   <script> 
     // Inicialização do OneSignal em segundo plano
     window.OneSignalDeferred = window.OneSignalDeferred || [];
     OneSignalDeferred.push(async function(OneSignal) {
       try {
         await OneSignal.init({
           appId: "61e6874c-bca0-4628-ad07-8053c0cd499e",
           serviceWorkerPath: "OneSignalSDK.sw.js",
           allowLocalhostAsSecureOrigin: true,
         });
       } catch (e) {
         console.warn('OneSignal error:', e);
       }
     });

     window.addEventListener('load', function(ev) { 
       _flutter.loader.loadEntrypoint({ 
         serviceWorker: {
           serviceWorkerVersion: typeof serviceWorkerVersion !== 'undefined' ? serviceWorkerVersion : null,
         },
         onEntrypointLoaded: function(engineInitializer) { 
           engineInitializer.initializeEngine().then(function(appRunner) { 
             const loadingIndicator = document.getElementById('loading-msg');
             if (loadingIndicator) loadingIndicator.remove();
             appRunner.runApp(); 
           }); 
         } 
       }); 
     }); 
   </script> 
 </body> 
 </html> 
