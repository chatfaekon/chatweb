<!DOCTYPE html> 
 <html> 
 <head> 
   <base href="/chatweb/"> 
   <meta charset="UTF-8"> 
   <title>Chat App</title> 
   <link rel="manifest" href="manifest.json"> 
   
   <script> 
     // Define o renderizador antes de tudo para evitar tela branca 
     window.flutterWebRenderer = "html"; 
   </script> 
 
   <script src="flutter.js" defer></script> 
   <!-- OneSignal SDK -->
   <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
 </head> 
 <body> 
   <div id="loading" style="display:flex;justify-content:center;align-items:center;height:100vh;font-family:sans-serif;"> 
     <div class="spinner"> Carregando sistema... </div> 
   </div> 
 
   <style> 
     .spinner { 
       border: 4px solid rgba(0,0,0,.1); 
       width: 36px; 
       height: 36px; 
       border-radius: 50%; 
       border-left-color: #09f; 
       animation: spin 1s linear infinite; 
     } 
     @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } } 
     body { margin: 0; background-color: #ffffff; }
   </style> 
 
   <script> 
     // Inicialização do OneSignal em segundo plano
     window.OneSignalDeferred = window.OneSignalDeferred || [];
     OneSignalDeferred.push(async function(OneSignal) {
       try {
         await OneSignal.init({
           appId: "61e6874c-bca0-4628-ad07-8053c0cd499e",
           serviceWorkerPath: "OneSignalSDK.sw.js",
           allowLocalhostAsSecureOrigin: true,
         });
       } catch (e) {
         console.warn('OneSignal init delayed/failed:', e);
       }
     });

     window.addEventListener('load', function(ev) { 
       // Download main.dart.js 
       _flutter.loader.loadEntrypoint({ 
         serviceWorker: { 
           serviceWorkerVersion: typeof serviceWorkerVersion !== 'undefined' ? serviceWorkerVersion : null, 
         }, 
         onEntrypointLoaded: function(engineInitializer) { 
           engineInitializer.initializeEngine().then(function(appRunner) { 
             const loadingIndicator = document.getElementById('loading');
             if (loadingIndicator) loadingIndicator.remove();
             appRunner.runApp(); 
           }); 
         } 
       }); 
     }); 
   </script> 
 </body> 
 </html> 
